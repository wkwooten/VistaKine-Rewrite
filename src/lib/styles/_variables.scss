// src/lib/styles/_variables.scss
// ==================================
// Color System Refactor
// ==================================

// When updating the variables ensure changes are reflected in documentation\Variables Overview.md file

// ----------------------------------
// Core Palette
// Purpose: Base colors for UI structure, text, and backgrounds.
// ----------------------------------
//#F8F9FA
$color-background: #f0f8ff;          // Main page background
$color-surface: #fefeff;             // Card/Sidebar/distinct element backgrounds
$color-surface-alt: #ebebef;
$color-text-primary: #1f2937;        // Primary text color
$color-text-secondary: #37474F; // Lighter text for secondary info (kept from brand)
$color-white: #ffffff;
$color-text-inverted-light: $color-white; // Value for light mode
$parallax-background-color: #1e65c821;


// ----------------------------------
// Accent Palette
// Purpose: Interactive elements, highlights, calls to action.
// ----------------------------------
$color-accent: #004d9f;               // Primary interactive color (was $brand-primary)
$color-border: rgba($color-accent, 0.2);              // Default border color
$color-border-light: rgba($color-border, 0.2); // Subtle borders/dividers
$color-accent-hover: #1565C0;         // Hover state for accent elements (was $brand-accent-dark)
$color-accent-light: #64B5F6;         // Lighter accent variation (was $brand-accent)
$color-accent-active-bg: rgba($color-accent, 0.08); // Background for active state (was $brand-active-bg)
$color-accent-hover-bg: rgba($color-accent-light, 1); // Background for hover state (was $brand-hover-bg)


// ----------------------------------
// Functional Colors
// Purpose: Specific UI states like success, error, warnings.
// ----------------------------------
$color-success: #10b981;
$color-error: #d32f2f;
$color-error-bg: rgba($color-error, 0.1);
$color-error-border: rgba($color-error, 0.3);
$color-text-on-dark: #F0F8FF; // Text used on dark/accent backgrounds

// Brand Colors (e.g., for third-party sign-in buttons)
$color-google-blue: #4285F4;
$color-google-blue-hover: #357AE8;
$color-apple-black: #000000;
$color-apple-black-hover: #1a1a1a; // A slightly lighter black or dark grey for hover
$color-apple-white: #ffffff;

// ----------------------------------
// Axis Colors (Used, Keep As Is)
// ----------------------------------
$axis-color-x: #B71C1C; // Darker Red for light mode contrast
$axis-color-y: #1B5E20; // Darker Green for light mode contrast
$axis-color-z: #0D47A1; // Darker Blue for light mode contrast
// Transparent versions...
$axis-color-x-t75: rgba($axis-color-x, 0.75);
$axis-color-y-t75: rgba($axis-color-y, 0.75);
$axis-color-z-t75: rgba($axis-color-z, 0.75);
$axis-color-x-t50: rgba($axis-color-x, 0.5);
$axis-color-y-t50: rgba($axis-color-y, 0.5);
$axis-color-z-t50: rgba($axis-color-z, 0.5);
$axis-color-x-t25: rgba($axis-color-x, 0.25);
$axis-color-y-t25: rgba($axis-color-y, 0.25);
$axis-color-z-t25: rgba($axis-color-z, 0.25);


// ----------------------------------
// Chapter Theme Colors (Used, Keep As Is)
// Purpose: Defined via CSS variables directly in :root, SCSS vars not strictly needed here unless used elsewhere in SCSS.
// We will define these directly as CSS variables below.
// ----------------------------------


// Typography
$font-family-base: 'IBM Plex Sans', sans-serif;
$font-family-heading: 'Titillium Web', sans-serif;
$font-family-monospace: 'IBM Plex Mono', monospace;

// Breakpoints (matching Utopia setup)
$min-viewport: 300px;
$max-viewport: 1240px;
$breakpoint-xs: $min-viewport;
$breakpoint-sm: 640px;
$breakpoint-md: 768px;
$breakpoint-lg: 1024px;
$breakpoint-xl: 1280px;
$breakpoint-2xl: 1536px;

// Transitions - Match with _animations.scss
$transition-fast: 150ms;
$transition-normal: 250ms;
$transition-slow: 350ms;
$transition-slower: 500ms;
$transition-opacity-fast: 100ms; // New variable for nav text opacity
$transition-bezier: cubic-bezier(0.4, 0, 0.2, 1);

// Dimensions
$max-content-width: 1000px;
$wide-content-width: 1400px;
$section-map-width: 320px;
$readable-max-width: 70ch; // Optimal reading width (ch units are width of "0" character)
$sidebar-width: 400px;
$sidebar-collapsed-width:80px;
$sidebar-width-full: 300px; // Consider consolidating with $sidebar-width
$sidebar-transition-duration: $transition-slow;
$sidebar-transition-timing: $transition-bezier;
$navbar-height: 80px;

// Shadows
$shadow-color: rgb(9, 4, 48); // Define the natural shadow base color

$shadow-sm: 0 2px 4px rgba($shadow-color, 0.05); // Was rgba(9, 4, 48, 0.05) - effectively the same
$shadow-md: 0 2px 10px rgba($shadow-color, 0.05); // Was rgba(0, 0, 0, 0.05)
$shadow-lg: 0 4px 15px rgba($shadow-color, 0.1); // Was rgba(0, 0, 0, 0.1)
$shadow-xl: 0 10px 25px rgba($shadow-color, 0.15); // Was rgba(0, 0, 0, 0.25)

// UI States
$state-selected-color: #007bff;

// Border radius - Migrated from old variables
$radius-xs: 2px;
$radius-sm: 4px;
$radius-md: 6px;
$radius-lg: 8px;
$radius-xl: 12px;
$radius-round: 50%;
$radius-pill: 9999px;

// Scene element colors (light) - DEFINED HERE
$scene-grid-cell-color-light: #ADD8E6;
$scene-grid-section-color-light: $color-accent-light; // #64B5F6
$scene-ground-color-light: #e0e0e0;

// --- Calibration Scene Specific (Light) ---
$calibration-nozzle-color-light: #4682b4; // steelblue
$calibration-nozzle-edges-color-light: #ADD8E6;
$calibration-height-indicator-color-light: #ADD8E6;
$calibration-bed-color-light: $color-white; // white
$calibration-bed-edges-color-light: #ADD8E6;
$calibration-target-pending-color-light: #FFA500; // orange
$calibration-target-hit-color-light: #32CD32;   // limegreen

// --- Vector Builder Colors (Light) ---
$vector-color: #8f2fd3;
$vector-builder-start-color-light: $color-accent;
$vector-builder-end-color-light: $color-accent-hover;

// ----------------------------------
// Character Colors
// ----------------------------------
$surya-color-light: #0D9488; // Teal 600
$leo-color-light: #1E40AF;  // Blue 800

// ==================================
// Export as CSS variables
// ==================================
:root {
  --pretentious_ratio: 0.6180339887;
  --font-mono: 'IBM Plex Mono', monospace;
  // Utopia Fluid Type Steps (Keep As Is)
  --step--2: clamp(0.6944rem, 0.6577rem + 0.1836vw, 0.8rem);
  --step--1: clamp(0.8333rem, 0.7754rem + 0.2899vw, 1rem);
  --step-0: clamp(1rem, 0.913rem + 0.4348vw, 1.25rem);
  --step-1: clamp(1.2rem, 1.0739rem + 0.6304vw, 1.5625rem);
  --step-2: clamp(1.44rem, 1.2615rem + 0.8924vw, 1.9531rem);
  --step-3: clamp(1.728rem, 1.4799rem + 1.2407vw, 2.4414rem);
  --step-4: clamp(2.0736rem, 1.7334rem + 1.7011vw, 3.0518rem);
  --step-5: clamp(2.4883rem, 2.027rem + 2.3067vw, 3.8147rem);
  --step-6: clamp(2.986rem, 2.366rem + 3.0998vw, 4.7684rem);

  // Utopia Fluid Space Steps (ASSUMING THESE EXIST - ADD YOURS HERE)
  // Example based on Utopia calculator link - replace with your actual clamp values
  --space-3xs: clamp(0.3125rem, 0.3125rem + 0vw, 0.3125rem);
  --space-2xs: clamp(0.5rem, 0.48rem + 0.1vw, 0.5625rem);
  --space-xs: clamp(0.75rem, 0.7199rem + 0.1504vw, 0.8438rem);
  --space-s: clamp(1rem, 0.913rem + 0.4348vw, 1.25rem); // Matches step-0
  --space-m: clamp(1.5rem, 1.3696rem + 0.6522vw, 1.875rem);
  --space-l: clamp(2rem, 1.8261rem + 0.8696vw, 2.5rem);
  --space-xl: clamp(3rem, 2.7391rem + 1.3043vw, 3.75rem);
  --space-2xl: clamp(4rem, 3.6522rem + 1.7391vw, 5rem);
  --space-3xl: clamp(6rem, 5.4783rem + 2.6087vw, 7.5rem);

  /* One-up pairs */
  --space-3xs-2xs: clamp(0.3125rem, 0.1976rem + 0.5743vw, 0.6875rem);
  --space-2xs-xs: clamp(0.5rem, 0.3648rem + 0.6757vw, 0.9375rem);
  --space-xs-s: clamp(0.75rem, 0.5881rem + 0.8097vw, 1.2813rem);
  --space-s-m: clamp(1rem, 0.6869rem + 1.5654vw, 1.9375rem);
  --space-m-l: clamp(1.5rem, 1.1435rem + 1.7827vw, 2.625rem);
  --space-l-xl: clamp(2rem, 1.3739rem + 3.1307vw, 4rem);
  --space-xl-2xl: clamp(3rem, 2.287rem + 3.5654vw, 5.25rem);
  --space-2xl-3xl: clamp(4rem, 2.7478rem + 6.2613vw, 8rem);

  /* Custom pairs */
  --space-s-l: clamp(1rem, 0.4565rem + 2.7174vw, 2.875rem); // Example custom pair often used for gutters

  // ==================================
  // Utopia Grid Variables
  // ==================================
  --grid-max-width: 77.5rem; /* 1240px / 16px */
  // Use a fluid space variable for the gutter. Adjust if --space-s-l doesn't exist or you prefer another step.
  --grid-gutter: var(--space-m, clamp(1.125rem, 0.6467rem + 2.3913vw, 2.5rem)); /* Example fallback clamp */
  --grid-columns: 12;
  // ==================================

  // Core Palette
  --color-background: #{$color-background};
  --color-surface: #{$color-surface};
  --color-surface-alt: #{$color-surface-alt};
  --color-text-primary: #{$color-text-primary};
  --color-text-secondary: #{$color-text-secondary};
  --color-border: #{$color-border};
  --color-border-light: #{$color-border-light};
  --color-white: #{$color-white};
  --color-text-inverted: #{$color-text-inverted-light};
  --parallax-background-color: #{$parallax-background-color};
  --color-overlay: #{rgba($color-white, 0.5)}; // Added for light mode

  // Accent Palette
  --color-accent: #{$color-accent};
  --color-accent-hover: #{$color-accent-hover};
  --color-accent-light: #{$color-accent-light};
  --color-accent-active-bg: #{$color-accent-active-bg};
  --color-accent-hover-bg: #{$color-accent-hover-bg};
  --color-surface-hover: #{rgba($color-accent-light, 0.15)};

  // Functional Colors
  --color-success: #{$color-success};
  --color-error: #{$color-error};
  --color-error-bg: #{$color-error-bg};
  --color-error-border: #{$color-error-border};
  --color-text-on-dark: #{$color-text-on-dark};

  // Axis Colors
  --axis-color-x: #{$axis-color-x};
  --axis-color-y: #{$axis-color-y};
  --axis-color-z: #{$axis-color-z};
  --axis-color-x-t75: #{$axis-color-x-t75};
  --axis-color-y-t75: #{$axis-color-y-t75};
  --axis-color-z-t75: #{$axis-color-z-t75};
  --axis-color-x-t50: #{$axis-color-x-t50};
  --axis-color-y-t50: #{$axis-color-y-t50};
  --axis-color-z-t50: #{$axis-color-z-t50};
  --axis-color-x-t25: #{$axis-color-x-t25};
  --axis-color-y-t25: #{$axis-color-y-t25};
  --axis-color-z-t25: #{$axis-color-z-t25};

  // ==========================================
  // Chapter Theme Colors - LIGHT MODE (Contrast + Early Saturation)
  // ==========================================

  // Chapter 1 (More Saturated Green)
  --chapter-color-1: #16A34A; // Green 600
  --chapter-color-light-1: #86EFAC; // Lighter variant
  --chapter-color-dark-1: #14532D; // Darker variant (Green 900)
  --chapter-header-bg-1: color-mix(in srgb, #16A34A 80%, black);
  --chapter-bg-1: rgba(22, 163, 74, 0.1); // RGBA of base color
  --chapter-sidebar-bg-1: rgba(22, 163, 74, 0.05); // RGBA of base color

  // Chapter 2 (More Saturated Teal)
  --chapter-color-2: #0D9488; // Teal 600
  --chapter-color-light-2: #5EEAD4; // Lighter variant (Teal 300)
  --chapter-color-dark-2: #115E59; // Darker variant (Teal 800)
  --chapter-header-bg-2: color-mix(in srgb, #0D9488 80%, black);
  --chapter-bg-2: rgba(13, 148, 136, 0.1);
  --chapter-sidebar-bg-2: rgba(13, 148, 136, 0.05);

  // Chapter 3 (No Change - Emerald 600)
  --chapter-color-3: #059669; // Emerald 600
  --chapter-color-light-3: #6EE7B7; // Lighter variant
  --chapter-color-dark-3: #065F46; // Darker variant
  --chapter-header-bg-3: color-mix(in srgb, #059669 80%, black);
  --chapter-bg-3: rgba(5, 150, 105, 0.1);
  --chapter-sidebar-bg-3: rgba(5, 150, 105, 0.05);

  // Chapter 4 (More Saturated Blue)
  --chapter-color-4: #2563EB; // Blue 600
  --chapter-color-light-4: #93C5FD; // Lighter variant (Blue 300)
  --chapter-color-dark-4: #1E40AF; // Darker variant (Blue 800)
  --chapter-header-bg-4: color-mix(in srgb, #2563EB 80%, black);
  --chapter-bg-4: rgba(37, 99, 235, 0.1);
  --chapter-sidebar-bg-4: rgba(37, 99, 235, 0.05);

  // Chapter 5 (Now Teal 700)
  --chapter-color-5: #0F766E; // Teal 700
  --chapter-color-light-5: #99F6E4; // Lighter variant
  --chapter-color-dark-5: #134E4A; // Darker variant
  --chapter-header-bg-5: color-mix(in srgb, #0F766E 80%, black);
  --chapter-bg-5: rgba(15, 118, 110, 0.1);
  --chapter-sidebar-bg-5: rgba(15, 118, 110, 0.05);

  // Chapter 6 (No Change - Indigo 600)
  --chapter-color-6: #4F46E5; // Indigo 600
  --chapter-color-light-6: #A5B4FC; // Lighter variant
  --chapter-color-dark-6: #3730A3; // Darker variant
  --chapter-header-bg-6: color-mix(in srgb, #4F46E5 80%, black);
  --chapter-bg-6: rgba(79, 70, 229, 0.1);
  --chapter-sidebar-bg-6: rgba(79, 70, 229, 0.05);

  // Chapter 7 (Now Sky Blue 700)
  --chapter-color-7: #0284C7; // Sky Blue 700
  --chapter-color-light-7: #7DD3FC; // Lighter variant
  --chapter-color-dark-7: #075985; // Darker variant
  --chapter-header-bg-7: color-mix(in srgb, #0284C7 80%, black);
  --chapter-bg-7: rgba(2, 132, 199, 0.1);
  --chapter-sidebar-bg-7: rgba(2, 132, 199, 0.05);

  // Chapter 8 (No Change - Blue 700)
  --chapter-color-8: #1D4ED8; // Blue 700
  --chapter-color-light-8: #60A5FA; // Lighter variant
  --chapter-color-dark-8: #1E3A8A; // Darker variant
  --chapter-header-bg-8: color-mix(in srgb, #1D4ED8 80%, black);
  --chapter-bg-8: rgba(29, 78, 216, 0.1);
  --chapter-sidebar-bg-8: rgba(29, 78, 216, 0.05);

  // Chapter 9 (No Change - Emerald 700)
  --chapter-color-9: #047857; // Emerald 700
  --chapter-color-light-9: #34D399; // Lighter variant
  --chapter-color-dark-9: #064E3B; // Darker variant
  --chapter-header-bg-9: color-mix(in srgb, #047857 80%, black);
  --chapter-bg-9: rgba(4, 120, 87, 0.1);
  --chapter-sidebar-bg-9: rgba(4, 120, 87, 0.05);

  // Chapter 10 (No Change - Cyan 900)
  --chapter-color-10: #164E63; // Cyan 900
  --chapter-color-light-10: #A5F3FC; // Lighter variant
  --chapter-color-dark-10: #1E3A8A; // Darker variant
  --chapter-header-bg-10: color-mix(in srgb, #164E63 80%, black);
  --chapter-bg-10: rgba(22, 78, 99, 0.1);
  --chapter-sidebar-bg-10: rgba(22, 78, 99, 0.05);


  // --- Fallback / Default Chapter Theme (Light Mode) ---
  --chapter-color-default: #1D4ED8; // Blue 700 as default
  --chapter-color-light-default: #60A5FA;
  --chapter-color-dark-default: #1E3A8A;
  --chapter-header-bg-default: color-mix(in srgb, #1D4ED8 80%, black);
  --chapter-bg-default: rgba(29, 78, 216, 0.1);
  --chapter-sidebar-bg-default: rgba(29, 78, 216, 0.05);

  // Typography (Base definitions - Keep As Is)
  --font-family-base: #{$font-family-base};
  --font-family-heading: #{$font-family-heading};

  // Breakpoints (Keep As Is)
  --breakpoint-xs: #{$breakpoint-xs};
  --breakpoint-sm: #{$breakpoint-sm};
  --breakpoint-md: #{$breakpoint-md};
  --breakpoint-lg: #{$breakpoint-lg};
  --breakpoint-xl: #{$breakpoint-xl};

  // Transitions (Keep As Is)
  --transition-fast: #{$transition-fast};
  --transition-normal: #{$transition-normal};
  --transition-slow: #{$transition-slow};
  --transition-slower: #{$transition-slower};
  --transition-opacity-fast: #{$transition-opacity-fast};
  --transition-bezier: #{$transition-bezier};

  // Dimensions (Keep As Is)
  --max-content-width: #{$max-content-width};
  --wide-content-width: #{$wide-content-width};
  --readable-max-width: #{$readable-max-width};
  --section-map-width: #{$section-map-width};
  --sidebar-width: #{$sidebar-width};
  --sidebar-collapsed-width: #{$sidebar-collapsed-width};
  --sidebar-width-full: #{$sidebar-width-full};
  --sidebar-transition-duration: #{$sidebar-transition-duration};
  --sidebar-transition-timing: #{$sidebar-transition-timing};

  // Shadows (Keep As Is)
  --shadow-sm: #{$shadow-sm};
  --shadow-md: #{$shadow-md};
  --shadow-lg: #{$shadow-lg};
  --shadow-xl: #{$shadow-xl}; // Added extra-large shadow variable

  --shadow-color: #{$shadow-color};

  // UI States (Keep As Is)
  --state-selected-color: #{$state-selected-color}; // Maybe rename to --color-selected-bg or similar? Or use accent?


  // Glassmorphism (Keep As Is - Uses CSS vars)
  --glass-bg-color: #{$color-surface} 90%;
  --glass-backdrop-blur: blur(8px);
  --glass-border-color: var(--color-accent);
  --glass-border: 1px solid var(--glass-border-color);

  // Border radius (Keep As Is)
  --radius-xs: #{$radius-xs};
  --radius-sm: #{$radius-sm};
  --radius-md: #{$radius-md};
  --radius-lg: #{$radius-lg};
  --radius-xl: #{$radius-xl};
  --radius-round: #{$radius-round};
  --radius-pill: #{$radius-pill};

  // Scene Elements (Light) - USED HERE
  --scene-grid-cell-color: #{$scene-grid-cell-color-light};
  --scene-grid-section-color: #{$scene-grid-section-color-light};
  --scene-ground-color: #{$scene-ground-color-light};
  --scene-ground-gradient-edge-color: #A9A9A9;

  // Calibration Scene (Light) - Usage is now AFTER definition
  --calibration-nozzle-color: #{$calibration-nozzle-color-light};
  --calibration-nozzle-edges-color: #{$calibration-nozzle-edges-color-light};
  --calibration-height-indicator-color: #{$calibration-height-indicator-color-light};
  --calibration-bed-color: #{$calibration-bed-color-light};
  --calibration-bed-edges-color: #{$calibration-bed-edges-color-light};
  --calibration-target-pending-color: #{$calibration-target-pending-color-light};
  --calibration-target-hit-color: #{$calibration-target-hit-color-light};

  // Vector Builder Colors (Light)
  --vector-builder-start-color: #{$vector-builder-start-color-light};
  --vector-builder-end-color: #{$vector-builder-end-color-light};
  --vector-color: #{$vector-color};

  // Character Colors (Light)
  --surya-color: #{$surya-color-light};
  --leo-color: #{$leo-color-light};

  // Brand Colors for CSS
  --color-google-blue: #{$color-google-blue};
  --color-google-blue-hover: #{$color-google-blue-hover};
  --color-bg-btn-apple: #{$color-apple-black};              // Default Apple button bg (black)
  --color-text-btn-apple: #{$color-apple-white};            // Default Apple button text (white)
  --color-border-btn-apple: #{$color-apple-black};
  --color-bg-btn-apple-hover: #{$color-apple-black-hover};
}

// ----------------------------------
// Dark Mode Palette (Midnight Purple Theme)
// ----------------------------------

// --- Core Dark ---
$color-dark-background: #1a1a2e;  // Very dark desaturated midnight blue/purple
$color-dark-surface: #2a2844;     // Slightly lighter dark purple for cards/sidebars
$color-dark-surface-alt: #1f1d38; // Darker purple for alternating surface
$color-dark-text-primary: #f0f8ff; // AliceBlue (re-using light bg) - very light for high contrast
$color-dark-text-secondary: #a0a0c0; // Desaturated light purple/grey for secondary text
$color-dark-border: #4d4a6d;       // Muted purple/grey border
$color-dark-border-light: rgba($color-dark-text-primary, 0.1); // Very subtle divider
$color-dark-text-inverted-dark: $color-dark-text-primary; // Value for dark mode (using light primary text)
$color-dark-parallax-background-color: #1e64c813;

// --- Accent Dark ---
$color-dark-accent: #66A3FF;        // NEW - Medium-light, vibrant blue
$color-dark-accent-hover: #80BFFF;  // NEW - Lighter blue for hover
$color-dark-accent-light: #619AE6;  // NEW - Slightly less saturated/darker blue
$color-dark-accent-active-bg: rgba($color-dark-accent, 0.15);
$color-dark-accent-hover-bg: rgba($color-dark-accent-hover, 0.1); // Use the new hover color here
$color-dark-accent-contrast: #48d1cc; // Vibrant Cyan/Teal (Keeping this as is for now)

// --- Functional Dark ---
$color-dark-success: #2ecc71;        // Bright green
$color-dark-error: #ff6b6b;          // Soft, bright red/pink
$color-dark-error-bg: rgba($color-dark-error, 0.15);
$color-dark-error-border: rgba($color-dark-error, 0.3);
$color-dark-text-on-dark: $color-dark-text-primary; // Primary light text works here
$color-dark-text-on-accent: #111; // Dark text might be needed on the bright dark-mode accents

// --- Axis Dark (Brighter versions for visibility) ---
$axis-dark-color-x: #EF5350; // Adjusted Bright Red
$axis-dark-color-y: #4CAF50; // Adjusted Bright Green
$axis-dark-color-z: #2979FF; // Adjusted Bright Blue
$axis-dark-color-x-t75: rgba($axis-dark-color-x, 0.75);
$axis-dark-color-y-t75: rgba($axis-dark-color-y, 0.75);
$axis-dark-color-z-t75: rgba($axis-dark-color-z, 0.75);
$axis-dark-color-x-t50: rgba($axis-dark-color-x, 0.5);
$axis-dark-color-y-t50: rgba($axis-dark-color-y, 0.5);
$axis-dark-color-z-t50: rgba($axis-dark-color-z, 0.5);
$axis-dark-color-x-t25: rgba($axis-dark-color-x, 0.25);
$axis-dark-color-y-t25: rgba($axis-dark-color-y, 0.25);
$axis-dark-color-z-t25: rgba($axis-dark-color-z, 0.25);

// Scene element colors (dark) - DEFINED HERE
$scene-grid-cell-color-dark: $color-dark-text-secondary; // #a0a0c0 (Brighter for contrast)
$scene-grid-section-color-dark: $color-dark-accent;      // #a779e1 (Even brighter accent)
$scene-ground-color-dark: #2A2844;                       // Darker purple ground center
$scene-ground-gradient-edge-dark: #24203d;                // Even darker purple ground edge

// --- Calibration Scene Specific (Dark) ---
$calibration-nozzle-color-dark: $color-dark-accent-contrast; // #48d1cc (Vibrant Cyan/Teal)
$calibration-nozzle-edges-color-dark: $color-dark-border;     // #4d4a6d
$calibration-height-indicator-color-dark: $color-dark-border; // #4d4a6d
$calibration-bed-color-dark: $color-dark-surface;             // #2a2844
$calibration-bed-edges-color-dark: $color-dark-border-light;  // rgba(dark-text, 0.1)
$calibration-target-pending-color-dark: #072fa6; // gold (stands out on dark)
$calibration-target-hit-color-dark: #50C878;    // emerald (brighter green)

// --- Vector Builder Colors (Dark) ---
$vector-builder-start-color-dark: $color-dark-accent;
$vector-builder-end-color-dark: $color-dark-accent-hover;

// ----------------------------------
// Character Colors (Dark)
// ----------------------------------
$surya-color-dark: #5EEAD4; // Teal 300
$leo-color-dark: #93C5FD;  // Blue 300

// ==================================
// Dark Mode Overrides
// ==================================
@media (prefers-color-scheme: dark) {
  :root {
    // -- Core Palette Override --
    --color-background: #{$color-dark-background};
    --color-surface: #{$color-dark-surface};
    --color-surface-alt: #{$color-dark-surface-alt};
    --color-text-primary: #{$color-dark-text-primary};
    --color-text-secondary: #{$color-dark-text-secondary};
    --color-border: #{$color-dark-border};
    --color-border-light: #{$color-dark-border-light};
    --color-text-inverted: #{$color-dark-text-inverted-dark};
    --parallax-background-color: #{$color-dark-parallax-background-color};
    --color-overlay: #{rgba($color-dark-background, 0.75)}; // Added for dark mode

    // -- Accent Palette Override --
    --color-accent: #{$color-dark-accent};
    --color-accent-hover: #{$color-dark-accent-hover};
    --color-accent-light: #{$color-dark-accent-light};
    --color-accent-active-bg: #{$color-dark-accent-active-bg};
    --color-accent-hover-bg: #{$color-dark-accent-hover-bg};
    --color-surface-hover: #{rgba($color-dark-accent-hover, 0.15)};

    // -- Functional Colors Override --
    --color-success: #{$color-dark-success};
    --color-error: #{$color-dark-error};
    --color-error-bg: #{$color-dark-error-bg};
    --color-error-border: #{$color-dark-error-border};
    --color-text-on-dark: #{$color-dark-text-on-dark};
    --color-dark-text-on-accent: #{$color-dark-text-on-accent};
    --color-surface-hover: #{rgba($color-dark-accent-hover, 0.15)};

    // -- Axis Colors Override --
    --axis-color-x: #{$axis-dark-color-x};
    --axis-color-y: #{$axis-dark-color-y};
    --axis-color-z: #{$axis-dark-color-z};
    --axis-color-x-t75: #{$axis-dark-color-x-t75};
    --axis-color-y-t75: #{$axis-dark-color-y-t75};
    --axis-color-z-t75: #{$axis-dark-color-z-t75};
    --axis-color-x-t50: #{$axis-dark-color-x-t50};
    --axis-color-y-t50: #{$axis-dark-color-y-t50};
    --axis-color-z-t50: #{$axis-dark-color-z-t50};
    --axis-color-x-t25: #{$axis-dark-color-x-t25};
    --axis-color-y-t25: #{$axis-dark-color-y-t25};
    --axis-color-z-t25: #{$axis-dark-color-z-t25};

    // Scene Elements (Dark) - USED HERE
    --scene-grid-cell-color: #{$scene-grid-cell-color-dark};
    --scene-grid-section-color: #{$scene-grid-section-color-dark};
    --scene-ground-color: #{$scene-ground-color-dark};
    --scene-ground-gradient-edge-color: #{$scene-ground-gradient-edge-dark};

    // Calibration Scene (Dark)
    --calibration-nozzle-color: #{$calibration-nozzle-color-dark};
    --calibration-nozzle-edges-color: #{$calibration-nozzle-edges-color-dark};
    --calibration-height-indicator-color: #{$calibration-height-indicator-color-dark};
    --calibration-bed-color: #{$calibration-bed-color-dark};
    --calibration-bed-edges-color: #{$calibration-bed-edges-color-dark};
    --calibration-target-pending-color: #{$calibration-target-pending-color-dark};
    --calibration-target-hit-color: #{$calibration-target-hit-color-dark};

    // Vector Builder Colors (Dark)
    --vector-builder-start-color: #{$vector-builder-start-color-dark};
    --vector-builder-end-color: #{$vector-builder-end-color-dark};

    // Character Colors (Dark)
    --surya-color: #{$surya-color-dark};
    --leo-color: #{$leo-color-dark};

    // ==========================================
    // Chapter Theme Colors - DARK MODE (Using the Lighter Palette from previous step)
    // ==========================================

    // Chapter 1
    --chapter-color-1: #A5D8FF; // Light Sky Blue
    --chapter-color-light-1: #E0F2FE;
    --chapter-color-dark-1: #6EB2E0;
    --chapter-header-bg-1: color-mix(in srgb, #A5D8FF 30%, #1a1a2e);
    --chapter-bg-1: rgba(165, 216, 255, 0.1);
    --chapter-sidebar-bg-1: rgba(165, 216, 255, 0.05);

    // Chapter 2
    --chapter-color-2: #99F6E4; // Light Aqua/Teal
    --chapter-color-light-2: #CFFDF0;
    --chapter-color-dark-2: #5DDBC0;
    --chapter-header-bg-2: color-mix(in srgb, #99F6E4 30%, #1a1a2e);
    --chapter-bg-2: rgba(153, 246, 228, 0.1);
    --chapter-sidebar-bg-2: rgba(153, 246, 228, 0.05);

    // Chapter 3
    --chapter-color-3: #84CC16; // Lime Green
    --chapter-color-light-3: #A3E635;
    --chapter-color-dark-3: #6DA80D;
    --chapter-header-bg-3: color-mix(in srgb, #84CC16 30%, #1a1a2e);
    --chapter-bg-3: rgba(132, 204, 22, 0.1);
    --chapter-sidebar-bg-3: rgba(132, 204, 22, 0.05);

    // Chapter 4
    --chapter-color-4: #67E8F9; // Cyan
    --chapter-color-light-4: #A5F3FC;
    --chapter-color-dark-4: #22D3EE;
    --chapter-header-bg-4: color-mix(in srgb, #67E8F9 30%, #1a1a2e);
    --chapter-bg-4: rgba(103, 232, 249, 0.1);
    --chapter-sidebar-bg-4: rgba(103, 232, 249, 0.05);

    // Chapter 5
    --chapter-color-5: #77CFF4; // Medium Sky Blue
    --chapter-color-light-5: #A8E1FA;
    --chapter-color-dark-5: #38BDF8;
    --chapter-header-bg-5: color-mix(in srgb, #77CFF4 30%, #1a1a2e);
    --chapter-bg-5: rgba(119, 207, 244, 0.1);
    --chapter-sidebar-bg-5: rgba(119, 207, 244, 0.05);

    // Chapter 6
    --chapter-color-6: #4DA6FF; // Medium Blue
    --chapter-color-light-6: #7ABFFF;
    --chapter-color-dark-6: #258AFB;
    --chapter-header-bg-6: color-mix(in srgb, #4DA6FF 30%, #1a1a2e);
    --chapter-bg-6: rgba(77, 166, 255, 0.1);
    --chapter-sidebar-bg-6: rgba(77, 166, 255, 0.05);

    // Chapter 7
    --chapter-color-7: #10B981; // Emerald Green
    --chapter-color-light-7: #34D399;
    --chapter-color-dark-7: #0B8A63;
    --chapter-header-bg-7: color-mix(in srgb, #10B981 30%, #1a1a2e);
    --chapter-bg-7: rgba(16, 185, 129, 0.1);
    --chapter-sidebar-bg-7: rgba(16, 185, 129, 0.05);

    // Chapter 8
    --chapter-color-8: #0891B2; // Medium Cyan/Teal
    --chapter-color-light-8: #22D3EE;
    --chapter-color-dark-8: #06758E;
    --chapter-header-bg-8: color-mix(in srgb, #0891B2 30%, #1a1a2e);
    --chapter-bg-8: rgba(8, 145, 178, 0.1);
    --chapter-sidebar-bg-8: rgba(8, 145, 178, 0.05);

    // Chapter 9
    --chapter-color-9: #0077CC; // Standard Link Blue
    --chapter-color-light-9: #38BDF8;
    --chapter-color-dark-9: #005FA3;
    --chapter-header-bg-9: color-mix(in srgb, #0077CC 30%, #1a1a2e);
    --chapter-bg-9: rgba(0, 119, 204, 0.1);
    --chapter-sidebar-bg-9: rgba(0, 119, 204, 0.05);

    // Chapter 10
    --chapter-color-10: #047857; // Dark Emerald Green
    --chapter-color-light-10: #10B981;
    --chapter-color-dark-10: #065F46;
    --chapter-header-bg-10: color-mix(in srgb, #047857 30%, #1a1a2e);
    --chapter-bg-10: rgba(4, 120, 87, 0.1);
    --chapter-sidebar-bg-10: rgba(4, 120, 87, 0.05);


    // --- Fallback / Default Chapter Theme (Dark Mode) ---
    // Use the dark mode accent color as base
    --chapter-color-default: var(--color-dark-accent); // #a779e1
    --chapter-color-light-default: var(--color-dark-accent-hover); // #c099f0
    --chapter-color-dark-default: var(--color-dark-accent-light); // #7b4db8
    --chapter-header-bg-default: color-mix(in srgb, var(--color-dark-accent) 30%, #1a1a2e);
    --chapter-bg-default: rgba(167, 121, 225, 0.1); // RGBA of dark accent
    --chapter-sidebar-bg-default: rgba(167, 121, 225, 0.05); // RGBA of dark accent

    // Brand Colors for CSS - Dark Mode (Apple button might invert)
    --color-google-blue: #{$color-google-blue}; // Google blue usually stays the same
    --color-google-blue-hover: #{$color-google-blue-hover};
    // For Apple, common dark mode practice is a white button with black text
    --color-bg-btn-apple: #{$color-apple-white};              // Apple button bg (white in dark mode)
    --color-text-btn-apple: #{$color-apple-black};            // Apple button text (black in dark mode)
    --color-border-btn-apple: #{$color-apple-white};
    --color-bg-btn-apple-hover: #{darken($color-apple-white, 5%)}; // Slightly off-white/grey for hover
  }
}

// Optional: Class for manual toggle
// .dark-mode {
//   // Copy variable overrides here
// }
