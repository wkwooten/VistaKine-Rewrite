// src/lib/styles/_variables.scss
// ==================================
// Color System Refactor
// ==================================

// ----------------------------------
// Core Palette
// Purpose: Base colors for UI structure, text, and backgrounds.
// ----------------------------------
$color-background: #f0f8ff;          // Main page background
$color-surface: #fefeff;             // Card/Sidebar/distinct element backgrounds
$color-text-primary: #1f2937;        // Primary text color
$color-text-secondary: #37474F; // Lighter text for secondary info (kept from brand)
$color-border: #5351EF;              // Default border color
$color-border-light: rgba($color-text-primary, 0.2); // Subtle borders/dividers
$color-white: #ffffff;
$color-text-inverted-light: $color-white; // Value for light mode

// ----------------------------------
// Accent Palette
// Purpose: Interactive elements, highlights, calls to action.
// ----------------------------------
$color-accent: #5351EF;               // Primary interactive color (was $brand-primary)
$color-accent-hover: #1565C0;         // Hover state for accent elements (was $brand-accent-dark)
$color-accent-light: #64B5F6;         // Lighter accent variation (was $brand-accent)
$color-accent-active-bg: rgba($color-accent, 0.08); // Background for active state (was $brand-active-bg)
$color-accent-hover-bg: rgba($color-accent-light, 0.15); // Background for hover state (was $brand-hover-bg)


// ----------------------------------
// Functional Colors
// Purpose: Specific UI states like success, error, warnings.
// ----------------------------------
$color-success: #10b981;
$color-error: #d32f2f;
$color-error-bg: rgba($color-error, 0.1);
$color-error-border: rgba($color-error, 0.3);
$color-text-on-dark: #F0F8FF; // Text used on dark/accent backgrounds

// ----------------------------------
// Axis Colors (Used, Keep As Is)
// ----------------------------------
$axis-color-x: #C62828; // Darker Red for light mode contrast
$axis-color-y: #2E7D32; // Darker Green for light mode contrast
$axis-color-z: #1565C0; // Darker Blue for light mode contrast
// Transparent versions...
$axis-color-x-t75: rgba($axis-color-x, 0.75);
$axis-color-y-t75: rgba($axis-color-y, 0.75);
$axis-color-z-t75: rgba($axis-color-z, 0.75);
$axis-color-x-t50: rgba($axis-color-x, 0.5);
$axis-color-y-t50: rgba($axis-color-y, 0.5);
$axis-color-z-t50: rgba($axis-color-z, 0.5);
$axis-color-x-t25: rgba($axis-color-x, 0.25);
$axis-color-y-t25: rgba($axis-color-y, 0.25);
$axis-color-z-t25: rgba($axis-color-z, 0.25);


// ----------------------------------
// Chapter Theme Colors (Used, Keep As Is)
// Purpose: Defined via CSS variables directly in :root, SCSS vars not strictly needed here unless used elsewhere in SCSS.
// We will define these directly as CSS variables below.
// ----------------------------------


// Typography
$font-family-base: 'IBM Plex Sans', sans-serif;
$font-family-heading: 'Titillium Web', sans-serif;

// Breakpoints (matching Utopia setup)
$min-viewport: 300px;
$max-viewport: 1240px;
$breakpoint-sm: 640px;
$breakpoint-md: 768px;
$breakpoint-lg: 1024px;
$breakpoint-2xl: 1536px;
$breakpoint-xl: 1280px;

// Transitions - Match with _animations.scss
$transition-fast: 150ms;
$transition-normal: 250ms;
$transition-slow: 350ms;
$transition-slower: 500ms;
$transition-bezier: cubic-bezier(0.4, 0, 0.2, 1);

// Dimensions
$max-content-width: 1000px;
$wide-content-width: 1400px;
$readable-max-width: 70ch; // Optimal reading width (ch units are width of "0" character)
$sidebar-width: 300px;
$sidebar-collapsed-width: 80px;
$sidebar-width-full: 300px; // Consider consolidating with $sidebar-width
$sidebar-width-mini: 100px;
$sidebar-transition-duration: $transition-normal;
$sidebar-transition-timing: $transition-bezier;

// Shadows
$shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.05);
$shadow-md: 0 2px 10px rgba(0, 0, 0, 0.05);
$shadow-lg: 0 5px 15px rgba(0, 0, 0, 0.1);

// UI States
$state-selected-color: #007bff;

// Border radius - Migrated from old variables
$radius-xs: 2px;
$radius-sm: 4px;
$radius-md: 6px;
$radius-lg: 8px;
$radius-xl: 12px;
$radius-round: 50%;
$radius-pill: 9999px;

// Scene element colors (light) - DEFINED HERE
$scene-grid-cell-color-light: #ADD8E6;
$scene-grid-section-color-light: $color-accent-light; // #64B5F6
$scene-ground-color-light: #e0e0e0;

// --- Calibration Scene Specific (Light) ---
$calibration-nozzle-color-light: #4682b4; // steelblue
$calibration-nozzle-edges-color-light: #ADD8E6;
$calibration-height-indicator-color-light: #ADD8E6;
$calibration-bed-color-light: $color-white; // white
$calibration-bed-edges-color-light: #ADD8E6;
$calibration-target-pending-color-light: #FFA500; // orange
$calibration-target-hit-color-light: #32CD32;   // limegreen

// ----------------------------------
// Character Colors
// ----------------------------------
$surya-color-light: #0D9488; // Teal 600
$leo-color-light: #1E40AF;  // Blue 800

// ==================================
// Export as CSS variables
// ==================================
:root {
  // Utopia Fluid Type Steps (Keep As Is)
  --step--2: clamp(0.7813rem, 0.7747rem + 0.0326vw, 0.8rem);
  --step--1: clamp(0.9375rem, 0.9158rem + 0.1087vw, 1rem);
  --step-0: clamp(1.125rem, 1.0815rem + 0.2174vw, 1.25rem);
  --step-1: clamp(1.35rem, 1.2761rem + 0.3696vw, 1.5625rem);
  --step-2: clamp(1.62rem, 1.5041rem + 0.5793vw, 1.9531rem);
  --step-3: clamp(1.944rem, 1.771rem + 0.8651vw, 2.4414rem);
  --step-4: clamp(2.3328rem, 2.0827rem + 1.2504vw, 3.0518rem);
  --step-5: clamp(2.7994rem, 2.4462rem + 1.7658vw, 3.8147rem);

  // Core Palette
  --color-background: #{$color-background};
  --color-surface: #{$color-surface};
  --color-text-primary: #{$color-text-primary};
  --color-text-secondary: #{$color-text-secondary};
  --color-border: #{$color-border};
  --color-border-light: #{$color-border-light};
  --color-white: #{$color-white};
  --color-text-inverted: #{$color-text-inverted-light};
  // Accent Palette
  --color-accent: #{$color-accent};
  --color-accent-hover: #{$color-accent-hover};
  --color-accent-light: #{$color-accent-light};
  --color-accent-active-bg: #{$color-accent-active-bg};
  --color-accent-hover-bg: #{$color-accent-hover-bg};


  // Functional Colors
  --color-success: #{$color-success};
  --color-error: #{$color-error};
  --color-error-bg: #{$color-error-bg};
  --color-error-border: #{$color-error-border};
  --color-text-on-dark: #{$color-text-on-dark};

  // Axis Colors
  --axis-color-x: #{$axis-color-x};
  --axis-color-y: #{$axis-color-y};
  --axis-color-z: #{$axis-color-z};
  --axis-color-x-t75: #{$axis-color-x-t75};
  --axis-color-y-t75: #{$axis-color-y-t75};
  --axis-color-z-t75: #{$axis-color-z-t75};
  --axis-color-x-t50: #{$axis-color-x-t50};
  --axis-color-y-t50: #{$axis-color-y-t50};
  --axis-color-z-t50: #{$axis-color-z-t50};
  --axis-color-x-t25: #{$axis-color-x-t25};
  --axis-color-y-t25: #{$axis-color-y-t25};
  --axis-color-z-t25: #{$axis-color-z-t25};

  // Chapter Theme Colors (Defined directly as CSS vars)
  --chapter-color-1: #10b981;
  --chapter-color-light-1: #6ee7b7;
  --chapter-color-dark-1: #047857;
  --chapter-color-2: #007bff;
  --chapter-color-light-2: #67b3ff;
  --chapter-color-dark-2: #0056b3;


  // Typography (Base definitions - Keep As Is)
  --font-family-base: #{$font-family-base};
  --font-family-heading: #{$font-family-heading};

  // Transitions (Keep As Is)
  --transition-fast: #{$transition-fast};
  --transition-normal: #{$transition-normal};
  --transition-slow: #{$transition-slow};
  --transition-slower: #{$transition-slower};
  --transition-bezier: #{$transition-bezier};

  // Dimensions (Keep As Is)
  --max-content-width: #{$max-content-width};
  --wide-content-width: #{$wide-content-width};
  --readable-max-width: #{$readable-max-width};
  --sidebar-width: #{$sidebar-width};
  --sidebar-collapsed-width: #{$sidebar-collapsed-width};
  --sidebar-width-full: #{$sidebar-width-full};
  --sidebar-width-mini: #{$sidebar-width-mini};
  --sidebar-transition-duration: #{$sidebar-transition-duration};
  --sidebar-transition-timing: #{$sidebar-transition-timing};

  // Shadows (Keep As Is)
  --shadow-sm: #{$shadow-sm};
  --shadow-md: #{$shadow-md};
  --shadow-lg: #{$shadow-lg};

  // UI States (Keep As Is)
  --state-selected-color: #{$state-selected-color}; // Maybe rename to --color-selected-bg or similar? Or use accent?


  // Glassmorphism (Keep As Is - Uses CSS vars)
  --glass-bg-color: #f9fafb 90%;
  --glass-backdrop-blur: blur(8px);
  --glass-border-color: var(--color-accent);
  --glass-border: 1px solid var(--glass-border-color);

  // Border radius (Keep As Is)
  --radius-xs: #{$radius-xs};
  --radius-sm: #{$radius-sm};
  --radius-md: #{$radius-md};
  --radius-lg: #{$radius-lg};
  --radius-xl: #{$radius-xl};
  --radius-round: #{$radius-round};
  --radius-pill: #{$radius-pill};

  // Scene Elements (Light) - USED HERE
  --scene-grid-cell-color: #{$scene-grid-cell-color-light};
  --scene-grid-section-color: #{$scene-grid-section-color-light};
  --scene-ground-color: #{$scene-ground-color-light};
  --scene-ground-gradient-edge-color: #A9A9A9;

  // Calibration Scene (Light) - Usage is now AFTER definition
  --calibration-nozzle-color: #{$calibration-nozzle-color-light};
  --calibration-nozzle-edges-color: #{$calibration-nozzle-edges-color-light};
  --calibration-height-indicator-color: #{$calibration-height-indicator-color-light};
  --calibration-bed-color: #{$calibration-bed-color-light};
  --calibration-bed-edges-color: #{$calibration-bed-edges-color-light};
  --calibration-target-pending-color: #{$calibration-target-pending-color-light};
  --calibration-target-hit-color: #{$calibration-target-hit-color-light};

  // Character Colors (Light)
  --surya-color: #{$surya-color-light};
  --leo-color: #{$leo-color-light};
}

// ----------------------------------
// Dark Mode Palette (Midnight Purple Theme)
// ----------------------------------

// --- Core Dark ---
$color-dark-background: #1a1a2e;  // Very dark desaturated midnight blue/purple
$color-dark-surface: #2a2844;     // Slightly lighter dark purple for cards/sidebars
$color-dark-text-primary: #f0f8ff; // AliceBlue (re-using light bg) - very light for high contrast
$color-dark-text-secondary: #a0a0c0; // Desaturated light purple/grey for secondary text
$color-dark-border: #4d4a6d;       // Muted purple/grey border
$color-dark-border-light: rgba($color-dark-text-primary, 0.1); // Very subtle divider
$color-dark-text-inverted-dark: $color-dark-text-primary; // Value for dark mode (using light primary text)

// --- Accent Dark ---
$color-dark-accent: #a779e1;        // A brighter, vibrant lavender/purple for interaction
$color-dark-accent-hover: #c099f0;  // Even brighter purple for hover
$color-dark-accent-light: #7b4db8;  // A less saturated purple (can adjust if needed)
$color-dark-accent-active-bg: rgba($color-dark-accent, 0.15);
$color-dark-accent-hover-bg: rgba($color-dark-accent-hover, 0.1);
$color-dark-accent-contrast: #48d1cc; // Vibrant Cyan/Teal

// --- Functional Dark ---
$color-dark-success: #2ecc71;        // Bright green
$color-dark-error: #ff6b6b;          // Soft, bright red/pink
$color-dark-error-bg: rgba($color-dark-error, 0.15);
$color-dark-error-border: rgba($color-dark-error, 0.3);
$color-dark-text-on-dark: $color-dark-text-primary; // Primary light text works here
$color-dark-text-on-accent: #111; // Dark text might be needed on the bright dark-mode accents

// --- Axis Dark (Brighter versions for visibility) ---
$axis-dark-color-x: #FF5252; // Adjusted Bright Red
$axis-dark-color-y: #69F0AE; // Adjusted Bright Green
$axis-dark-color-z: #448AFF; // Adjusted Bright Blue
$axis-dark-color-x-t75: rgba($axis-dark-color-x, 0.75);
$axis-dark-color-y-t75: rgba($axis-dark-color-y, 0.75);
$axis-dark-color-z-t75: rgba($axis-dark-color-z, 0.75);
$axis-dark-color-x-t50: rgba($axis-dark-color-x, 0.5);
$axis-dark-color-y-t50: rgba($axis-dark-color-y, 0.5);
$axis-dark-color-z-t50: rgba($axis-dark-color-z, 0.5);
$axis-dark-color-x-t25: rgba($axis-dark-color-x, 0.25);
$axis-dark-color-y-t25: rgba($axis-dark-color-y, 0.25);
$axis-dark-color-z-t25: rgba($axis-dark-color-z, 0.25);

// Scene element colors (dark) - DEFINED HERE
$scene-grid-cell-color-dark: $color-dark-text-secondary; // #a0a0c0 (Brighter for contrast)
$scene-grid-section-color-dark: $color-dark-accent;      // #a779e1 (Even brighter accent)
$scene-ground-color-dark: #2A2844;                       // Darker purple ground center
$scene-ground-gradient-edge-dark: #24203d;                // Even darker purple ground edge

// --- Calibration Scene Specific (Dark) ---
$calibration-nozzle-color-dark: $color-dark-accent-contrast; // #48d1cc (Vibrant Cyan/Teal)
$calibration-nozzle-edges-color-dark: $color-dark-border;     // #4d4a6d
$calibration-height-indicator-color-dark: $color-dark-border; // #4d4a6d
$calibration-bed-color-dark: $color-dark-surface;             // #2a2844
$calibration-bed-edges-color-dark: $color-dark-border-light;  // rgba(dark-text, 0.1)
$calibration-target-pending-color-dark: #FFD700; // gold (stands out on dark)
$calibration-target-hit-color-dark: #50C878;    // emerald (brighter green)

// ----------------------------------
// Character Colors (Dark)
// ----------------------------------
$surya-color-dark: #5EEAD4; // Teal 300
$leo-color-dark: #93C5FD;  // Blue 300

// ==================================
// Export as CSS variables
// ==================================
:root {
  // ... (existing :root block with light mode CSS variables) ...
  --color-white: #{$color-white};
  --color-text-inverted: #{$color-text-inverted-light};

  // Scene Elements (Light) - USED HERE
  --scene-grid-cell-color: #{$scene-grid-cell-color-light};
  --scene-grid-section-color: #{$scene-grid-section-color-light};
  --scene-ground-color: #{$scene-ground-color-light};
  --scene-ground-gradient-edge-color: #A9A9A9;

  // Calibration Scene (Light)
  --calibration-nozzle-color: #{$calibration-nozzle-color-light};
  --calibration-nozzle-edges-color: #{$calibration-nozzle-edges-color-light};
  --calibration-height-indicator-color: #{$calibration-height-indicator-color-light};
  --calibration-bed-color: #{$calibration-bed-color-light};
  --calibration-bed-edges-color: #{$calibration-bed-edges-color-light};
  --calibration-target-pending-color: #{$calibration-target-pending-color-light};
  --calibration-target-hit-color: #{$calibration-target-hit-color-light};

  // Character Colors (Light)
  --surya-color: #{$surya-color-light};
  --leo-color: #{$leo-color-light};

  // Accent Palette
  // ... rest of light mode :root ...
}

// ==================================
// Dark Mode Overrides
// ==================================
@media (prefers-color-scheme: dark) {
  :root {
    // -- Core Palette Override --
    --color-background: #{$color-dark-background};
    --color-surface: #{$color-dark-surface};
    --color-text-primary: #{$color-dark-text-primary};
    --color-text-secondary: #{$color-dark-text-secondary};
    --color-border: #{$color-dark-border};
    --color-border-light: #{$color-dark-border-light};
    --color-text-inverted: #{$color-dark-text-inverted-dark};

    // -- Accent Palette Override --
    --color-accent: #{$color-dark-accent};
    --color-accent-hover: #{$color-dark-accent-hover};
    --color-accent-light: #{$color-dark-accent-light};
    --color-accent-active-bg: #{$color-dark-accent-active-bg};
    --color-accent-hover-bg: #{$color-dark-accent-hover-bg};

    // -- Functional Colors Override --
    --color-success: #{$color-dark-success};
    --color-error: #{$color-dark-error};
    --color-error-bg: #{$color-dark-error-bg};
    --color-error-border: #{$color-dark-error-border};
    --color-text-on-dark: #{$color-dark-text-on-dark};
    // Consider adding --color-text-on-accent if needed: #{$color-dark-text-on-accent};

    // -- Axis Colors Override --
    --axis-color-x: #{$axis-dark-color-x};
    --axis-color-y: #{$axis-dark-color-y};
    --axis-color-z: #{$axis-dark-color-z};
    --axis-color-x-t75: #{$axis-dark-color-x-t75};
    --axis-color-y-t75: #{$axis-dark-color-y-t75};
    --axis-color-z-t75: #{$axis-dark-color-z-t75};
    --axis-color-x-t50: #{$axis-dark-color-x-t50};
    --axis-color-y-t50: #{$axis-dark-color-y-t50};
    --axis-color-z-t50: #{$axis-dark-color-z-t50};
    --axis-color-x-t25: #{$axis-dark-color-x-t25};
    --axis-color-y-t25: #{$axis-dark-color-y-t25};
    --axis-color-z-t25: #{$axis-dark-color-z-t25};

    // Scene Elements (Dark) - USED HERE
    --scene-grid-cell-color: #{$scene-grid-cell-color-dark};
    --scene-grid-section-color: #{$scene-grid-section-color-dark};
    --scene-ground-color: #{$scene-ground-color-dark};
    --scene-ground-gradient-edge-color: #{$scene-ground-gradient-edge-dark};

    // Calibration Scene (Dark)
    --calibration-nozzle-color: #{$calibration-nozzle-color-dark};
    --calibration-nozzle-edges-color: #{$calibration-nozzle-edges-color-dark};
    --calibration-height-indicator-color: #{$calibration-height-indicator-color-dark};
    --calibration-bed-color: #{$calibration-bed-color-dark};
    --calibration-bed-edges-color: #{$calibration-bed-edges-color-dark};
    --calibration-target-pending-color: #{$calibration-target-pending-color-dark};
    --calibration-target-hit-color: #{$calibration-target-hit-color-dark};

    // Character Colors (Dark)
    --surya-color: #{$surya-color-dark};
    --leo-color: #{$leo-color-dark};
  }
}

// Optional: Class for manual toggle
// .dark-mode {
//   // Copy variable overrides here
// }
